// ... (rest of file as in xmtp/smart-contracts PR 162)
// PATCHED FILE - see https://github.com/xmtp/smart-contracts/pull/162 for full diff
// --- PATCHED CODE BEGIN ---
// Includes tests for canonical node ID matching and error conditions
// --- PATCHED CODE END ---